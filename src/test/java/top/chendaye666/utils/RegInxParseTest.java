package top.chendaye666.utils;

import java.text.DateFormat;
import java.text.ParsePosition;
import java.text.SimpleDateFormat;
import java.util.Date;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class RegInxParseTest {

  @Test
  void timeTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String time = RegInxParse.matcherValByReg(log, "\\[(\\d{8} \\d{9,})", 1);

    DateFormat dateFormat = new SimpleDateFormat("yyyyMMdd HHmmssSSS");
    Date date = null;
    date = dateFormat.parse(time, new ParsePosition(0));
    String format = dateFormat.format(date);
    System.out.println(date.getTime());
  }

  @Test
  void logTypeTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "\\[(send|recv|pub1)\\]", 1);
    System.out.println(s);
  }

  @Test
  void qdNumberTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "\\[(send|recv|pub1)\\] \\[(10388101|00102025)\\] \\[(.*?)\\]", 3);
    System.out.println(s);
  }

  @Test
  void seatTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "8810\\\":\\\"(\\d{1,})\\\"", 1);
    System.out.println(s);
  }

  @Test
  void marketTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "\\\"(625|STKBD)\\\":\\\"(\\d{2})\\\"", 2);
    System.out.println(s);
  }

  @Test
  void capAccTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "(8920|CUACCT_CODE)\\\":\\\"(\\d+)\\\"", 2);
    System.out.println(s);
  }

  @Test
  void subordernoTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "9102\\\":\\\"(\\d+)\\\"", 1);
    System.out.println(s);
  }

  @Test
  void wtNumTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "8816\\\":\\\"(.*?)\\\"", 1);
    System.out.println(s);
  }

  @Test
  void contractNumTest() {
    String log = "[20210727 094417866] [    171.18.13.100] [recv] [10388101] [bb4f9716ce0945fb8fd97caaeda7f0e9]  000007320457 MAP01BR0 00000000000000000bb4f9716ce0945fb8fd97caaeda7f0e900000000000000000000000000000000103881010000000000001000100000576AAAAAAAAAAAAAAAA3706{\"38\":\"700.000\",\"40\":\"100\",\"44\":\"8.310\",\"448\":\"E062304923\",\"48\":\"600888\",\"625\":\"10\",\"8810\":\"34324468\",\"8811\":\"1\",\"8812\":\"PC;IIP=39.108.143.229;IPORT=14871;LIP=172.18.17.80;MAC=00163E141CCE;HD=WZ9I1RF2UMUEM5HVBSCL;PCN=IZSG02JNYNJWO9Z;CPU=0F8BFBFF00050654;PI=C^NTFS^39G;VOL=AAB7-EF14;@XTQMT;1.0.0.21949\",\"8813\":\"P\",\"8814\":\"139134324468        2107272107272359590000000001TbCo1359MbQ=eFJtxYSMx1QvCtpjLYHviUf+6DLmXBSFBwMmsZ9Xatg=\",\"8815\":\"10388101\",\"8816\":\"20210727094417000\",\"8821\":\"8161\",\"8826\":\"3\",\"8842\":\"700\",\"8902\":\"34324468\",\"8920\":\"79197221\",\"9101\":\"0\",\"9102\":\"235143178\"}\n" +
        "\n";
    String s = RegInxParse.matcherValByReg(log, "8920\\\":\\\"(.*?)\\\"", 1);
    System.out.println(s);
  }
}